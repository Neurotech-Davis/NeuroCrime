# NeuroCrime GitHub Repo

This repo consists of:

1. The PsychoPy stimulus procedure and its associated stimulus.

2. A script to combine EEG data recorded via OpenBCI with the PyschoPy procedure data files.

3. Data analysis scripts on the combined EEG data.

4. A script to download YouTube videos to use as stimulus.

### Project Description:

The Neurocrime project was designed to analyze the accuracy of a participant's recollection of an event. Our goal was to be able to distinguish if someone could accurately identify the correct suspect among innocent people. Due to the ethical constraints and difficulty of finding reliable crime videos, we had to switch our media to basketball clips. This made us adjust our experimental design to make the participants identify the individual who scored in the basketball clip.

[View our conference poster](https://drive.google.com/file/d/1IcV2IrhfATR6CEAfNx07lX8Q189STZsD/view?usp=sharing)

##### Stimulus

We used PsychoPy to generate the stimulus for our participants. The `.psyexp` file is XML data used to interact with the PsychoPy GUI, while the `.py` file is the actual Python script generated to run the experiment. Both are useful.

The stimulus consists of 1 short training trial, followed by 5 full length evaluation trials. The experiment was intended to be paired with EEG recording simultaneously (we used OpenBCI), and aligned in data analysis using the event flags generated by PsychoPy.

##### Data analysis

View our recorded data archive [here](https://ucdavis.box.com/s/l8p46d4dy868etbkogidt4xwzfgcwlzl). (It's large and doesn't play well with GitHub).

For our data analysis pipeline, we broke it down into stages (_note: notebooks with a 2 are my 'cleaner' do-over_:

1. **Generating Event Codes** — [Notebook](https://github.com/Neurotech-Davis/NeuroCrime/blob/main/DataAnalysis/GeneratingEventCodes.ipynb)  
   Links OpenBCI recordings with PsychoPy event flags, saving linked data in `.fif` format.

2. **Filtering** — [Notebook](https://github.com/Neurotech-Davis/NeuroCrime/blob/main/DataAnalysis/Filtering2.ipynb)  
   EEG preprocessing: band-pass filter (0.1–40 Hz), bad channel removal.

3. **Artifact Correction** — [Notebook](https://github.com/Neurotech-Davis/NeuroCrime/blob/main/DataAnalysis/Artifacts2.ipynb)  
   ICA-based artifact removal with visualizations of components.

4. **Segmentation** — [Notebook](https://github.com/Neurotech-Davis/NeuroCrime/blob/main/DataAnalysis/Segmentation2.ipynb)  
   Recordings segmented by event type: TP, TN, FP, FN, and “clench” as a sanity check.

5. **Evoked Visualizations** — [Notebook](https://github.com/Neurotech-Davis/NeuroCrime/blob/main/DataAnalysis/Evoked.ipynb)  
   Final results with graphics used in the conference poster.

##### Utilities to prepare experiment

We created a YouTube downloading script to obtain high quality footage to use as stimulus.

The downloader script needs to download .webm files in order to maintain as high quality as possible. Converting to mp4 with high resolution can take a while, so we suggest clipping the .webm file before converting.

Clipping webm:

1. Clip the webm file with audio

```
ffmpeg -i input.webm -ss 00:01:30 -to 00:02:00 -c copy clip.webm
```

2. Clip the webm file without audio. -an flag means no audio.

```
ffmpeg -i input.webm -ss 00:01:30 -to 00:02:00 -c:v copy -an clip.webm
```

Converting to mp4:

3. Fast, but a little loss.

```
ffmpeg -i input.webm -c:v copy -an output.mp4
```

4. Slower, but less loss

```
ffmpeg -i input.webm -c:v libx264 -crf 18 -preset slow -an output.mp4
```
